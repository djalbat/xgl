"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return MouseEvents;
    }
});
const _eventTypes = require("../eventTypes");
class MouseEvents {
    constructor(handlersMap, mouseDown){
        this.handlersMap = handlersMap;
        this.mouseDown = mouseDown;
    }
    wheelEventListener = (event)=>{
        const handlers = this.handlersMap[_eventTypes.WHEEL_EVENT_TYPE], mouseWheelDelta = mouseWheelDeltaFromEvent(event);
        handlers.forEach((handler)=>{
            handler(mouseWheelDelta);
        });
        event.preventDefault();
    };
    mouseEventListener = (event, eventType)=>{
        const handlers = this.handlersMap[eventType], mouseCoordinates = mouseCoordinatesFromEvent(event);
        handlers.forEach((handler)=>{
            handler(mouseCoordinates, this.mouseDown);
        });
        event.preventDefault();
    };
    mouseUpEventListener = (event)=>{
        this.mouseDown = false;
        this.mouseEventListener(event, _eventTypes.MOUSEUP_EVENT_TYPE);
    };
    mouseDownEventListener = (event)=>{
        this.mouseDown = true;
        this.mouseEventListener(event, _eventTypes.MOUSEDOWN_EVENT_TYPE);
    };
    mouseMoveEventListener = (event)=>{
        this.mouseEventListener(event, _eventTypes.MOUSEMOVE_EVENT_TYPE);
    };
    addMouseUpHandler(mouseUpHandler) {
        const mouseUpHandlers = this.handlersMap[_eventTypes.MOUSEUP_EVENT_TYPE];
        mouseUpHandlers.push(mouseUpHandler);
    }
    addMouseDownHandler(mouseDownHandler) {
        const mouseDownHandlers = this.handlersMap[_eventTypes.MOUSEDOWN_EVENT_TYPE];
        mouseDownHandlers.push(mouseDownHandler);
    }
    addMouseMoveHandler(mouseMoveHandler) {
        const mouseMoveHandlers = this.handlersMap[_eventTypes.MOUSEMOVE_EVENT_TYPE];
        mouseMoveHandlers.push(mouseMoveHandler);
    }
    addMouseWheelHandler(mouseWheelHandler) {
        const mouseWheelHandlers = this.handlersMap[_eventTypes.WHEEL_EVENT_TYPE];
        mouseWheelHandlers.push(mouseWheelHandler);
    }
    initialise(canvas) {
        const canvasDOMElement = canvas.getDOMElement();
        this.handlersMap[_eventTypes.WHEEL_EVENT_TYPE] = [];
        this.handlersMap[_eventTypes.MOUSEUP_EVENT_TYPE] = [];
        this.handlersMap[_eventTypes.MOUSEDOWN_EVENT_TYPE] = [];
        this.handlersMap[_eventTypes.MOUSEMOVE_EVENT_TYPE] = [];
        canvasDOMElement.addEventListener(_eventTypes.WHEEL_EVENT_TYPE, this.wheelEventListener);
        canvasDOMElement.addEventListener(_eventTypes.MOUSEUP_EVENT_TYPE, this.mouseUpEventListener);
        canvasDOMElement.addEventListener(_eventTypes.MOUSEDOWN_EVENT_TYPE, this.mouseDownEventListener);
        canvasDOMElement.addEventListener(_eventTypes.MOUSEMOVE_EVENT_TYPE, this.mouseMoveEventListener);
    }
    static fromNothing() {
        const handlersMap = {}, mouseDown = false, mouseEvents = new MouseEvents(handlersMap, mouseDown);
        return mouseEvents;
    }
}
function mouseWheelDeltaFromEvent(event) {
    const { wheelDelta } = event, mouseWheelDelta = Math.max(-1, Math.min(1, wheelDelta)); ///
    return mouseWheelDelta;
}
function mouseCoordinatesFromEvent(event) {
    const { target, clientX, clientY } = event, canvasDOMElement = target, boundingClientRect = canvasDOMElement.getBoundingClientRect(), { top, left } = boundingClientRect, mouseCoordinates = [
        clientX - left,
        top - clientY
    ];
    return mouseCoordinates;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9taXNjZWxsYW5lb3VzL21vdXNlRXZlbnRzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5pbXBvcnQgeyBXSEVFTF9FVkVOVF9UWVBFLCBNT1VTRVVQX0VWRU5UX1RZUEUsIE1PVVNFRE9XTl9FVkVOVF9UWVBFLCBNT1VTRU1PVkVfRVZFTlRfVFlQRSB9IGZyb20gXCIuLi9ldmVudFR5cGVzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vdXNlRXZlbnRzIHtcbiAgY29uc3RydWN0b3IoaGFuZGxlcnNNYXAsIG1vdXNlRG93bikge1xuICAgIHRoaXMuaGFuZGxlcnNNYXAgPSBoYW5kbGVyc01hcDtcbiAgICB0aGlzLm1vdXNlRG93biA9IG1vdXNlRG93bjtcbiAgfVxuXG4gIHdoZWVsRXZlbnRMaXN0ZW5lciA9IChldmVudCkgPT4ge1xuICAgIGNvbnN0IGhhbmRsZXJzID0gdGhpcy5oYW5kbGVyc01hcFsgV0hFRUxfRVZFTlRfVFlQRSBdLFxuICAgICAgICAgIG1vdXNlV2hlZWxEZWx0YSA9IG1vdXNlV2hlZWxEZWx0YUZyb21FdmVudChldmVudCk7XG5cbiAgICBoYW5kbGVycy5mb3JFYWNoKChoYW5kbGVyKSA9PiB7XG4gICAgICBoYW5kbGVyKG1vdXNlV2hlZWxEZWx0YSk7XG4gICAgfSk7XG5cbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICB9XG5cbiAgbW91c2VFdmVudExpc3RlbmVyID0gKGV2ZW50LCBldmVudFR5cGUpID0+IHtcbiAgICBjb25zdCBoYW5kbGVycyA9IHRoaXMuaGFuZGxlcnNNYXBbZXZlbnRUeXBlXSxcbiAgICAgICAgICBtb3VzZUNvb3JkaW5hdGVzID0gbW91c2VDb29yZGluYXRlc0Zyb21FdmVudChldmVudCk7XG5cbiAgICBoYW5kbGVycy5mb3JFYWNoKChoYW5kbGVyKSA9PiB7XG4gICAgICBoYW5kbGVyKG1vdXNlQ29vcmRpbmF0ZXMsIHRoaXMubW91c2VEb3duKTtcbiAgICB9KTtcblxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIH1cblxuICBtb3VzZVVwRXZlbnRMaXN0ZW5lciA9IChldmVudCkgPT4ge1xuICAgIHRoaXMubW91c2VEb3duID0gZmFsc2U7XG5cbiAgICB0aGlzLm1vdXNlRXZlbnRMaXN0ZW5lcihldmVudCwgTU9VU0VVUF9FVkVOVF9UWVBFKTtcbiAgfVxuXG5cdG1vdXNlRG93bkV2ZW50TGlzdGVuZXIgPSAoZXZlbnQpID0+IHtcbiAgICB0aGlzLm1vdXNlRG93biA9IHRydWU7XG5cbiAgICB0aGlzLm1vdXNlRXZlbnRMaXN0ZW5lcihldmVudCwgTU9VU0VET1dOX0VWRU5UX1RZUEUpO1xuICB9XG5cblx0bW91c2VNb3ZlRXZlbnRMaXN0ZW5lciA9IChldmVudCkgPT4ge1xuICAgIHRoaXMubW91c2VFdmVudExpc3RlbmVyKGV2ZW50LCBNT1VTRU1PVkVfRVZFTlRfVFlQRSk7XG4gIH1cblxuICBhZGRNb3VzZVVwSGFuZGxlcihtb3VzZVVwSGFuZGxlcikge1xuICAgIGNvbnN0IG1vdXNlVXBIYW5kbGVycyA9IHRoaXMuaGFuZGxlcnNNYXBbIE1PVVNFVVBfRVZFTlRfVFlQRSBdO1xuXG4gICAgbW91c2VVcEhhbmRsZXJzLnB1c2gobW91c2VVcEhhbmRsZXIpO1xuICB9XG5cbiAgYWRkTW91c2VEb3duSGFuZGxlcihtb3VzZURvd25IYW5kbGVyKSB7XG4gICAgY29uc3QgbW91c2VEb3duSGFuZGxlcnMgPSB0aGlzLmhhbmRsZXJzTWFwWyBNT1VTRURPV05fRVZFTlRfVFlQRSBdO1xuXG4gICAgbW91c2VEb3duSGFuZGxlcnMucHVzaChtb3VzZURvd25IYW5kbGVyKTtcbiAgfVxuXG4gIGFkZE1vdXNlTW92ZUhhbmRsZXIobW91c2VNb3ZlSGFuZGxlcikge1xuICAgIGNvbnN0IG1vdXNlTW92ZUhhbmRsZXJzID0gdGhpcy5oYW5kbGVyc01hcFsgTU9VU0VNT1ZFX0VWRU5UX1RZUEUgXTtcblxuICAgIG1vdXNlTW92ZUhhbmRsZXJzLnB1c2gobW91c2VNb3ZlSGFuZGxlcik7XG4gIH1cblxuICBhZGRNb3VzZVdoZWVsSGFuZGxlcihtb3VzZVdoZWVsSGFuZGxlcikge1xuICAgIGNvbnN0IG1vdXNlV2hlZWxIYW5kbGVycyA9IHRoaXMuaGFuZGxlcnNNYXBbIFdIRUVMX0VWRU5UX1RZUEUgXTtcblxuICAgIG1vdXNlV2hlZWxIYW5kbGVycy5wdXNoKG1vdXNlV2hlZWxIYW5kbGVyKTtcbiAgfVxuXG4gIGluaXRpYWxpc2UoY2FudmFzKSB7XG4gICAgICBjb25zdCBjYW52YXNET01FbGVtZW50ID0gY2FudmFzLmdldERPTUVsZW1lbnQoKTtcblxuICAgIHRoaXMuaGFuZGxlcnNNYXBbIFdIRUVMX0VWRU5UX1RZUEUgXSA9IFtdO1xuICAgIHRoaXMuaGFuZGxlcnNNYXBbIE1PVVNFVVBfRVZFTlRfVFlQRSBdID0gW107XG4gICAgdGhpcy5oYW5kbGVyc01hcFsgTU9VU0VET1dOX0VWRU5UX1RZUEUgXSA9IFtdO1xuICAgIHRoaXMuaGFuZGxlcnNNYXBbIE1PVVNFTU9WRV9FVkVOVF9UWVBFIF0gPSBbXTtcblxuICAgIGNhbnZhc0RPTUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihXSEVFTF9FVkVOVF9UWVBFLCB0aGlzLndoZWVsRXZlbnRMaXN0ZW5lcik7XG4gICAgY2FudmFzRE9NRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKE1PVVNFVVBfRVZFTlRfVFlQRSwgdGhpcy5tb3VzZVVwRXZlbnRMaXN0ZW5lcik7XG4gICAgY2FudmFzRE9NRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKE1PVVNFRE9XTl9FVkVOVF9UWVBFLCB0aGlzLm1vdXNlRG93bkV2ZW50TGlzdGVuZXIpO1xuICAgIGNhbnZhc0RPTUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihNT1VTRU1PVkVfRVZFTlRfVFlQRSwgdGhpcy5tb3VzZU1vdmVFdmVudExpc3RlbmVyKTtcbiAgfVxuXG4gIHN0YXRpYyBmcm9tTm90aGluZygpIHtcbiAgICBjb25zdCBoYW5kbGVyc01hcCA9IHt9LFxuICAgICAgICAgIG1vdXNlRG93biA9IGZhbHNlLCAgLy8vXG5cdFx0XHRcdFx0bW91c2VFdmVudHMgPSBuZXcgTW91c2VFdmVudHMoaGFuZGxlcnNNYXAsIG1vdXNlRG93bik7XG5cbiAgICByZXR1cm4gbW91c2VFdmVudHM7XG4gIH1cbn1cblxuZnVuY3Rpb24gbW91c2VXaGVlbERlbHRhRnJvbUV2ZW50KGV2ZW50KSB7XG4gIGNvbnN0IHsgd2hlZWxEZWx0YSB9ID0gZXZlbnQsXG4gICAgICAgIG1vdXNlV2hlZWxEZWx0YSA9IE1hdGgubWF4KC0xLCBNYXRoLm1pbigxLCB3aGVlbERlbHRhKSk7IC8vL1xuXG4gIHJldHVybiBtb3VzZVdoZWVsRGVsdGE7XG59XG5cbmZ1bmN0aW9uIG1vdXNlQ29vcmRpbmF0ZXNGcm9tRXZlbnQoZXZlbnQpIHtcbiAgY29uc3QgeyB0YXJnZXQsIGNsaWVudFgsIGNsaWVudFkgfSA9IGV2ZW50LFxuICAgICAgICBjYW52YXNET01FbGVtZW50ID0gdGFyZ2V0LCAgLy8vXG4gICAgICAgIGJvdW5kaW5nQ2xpZW50UmVjdCA9IGNhbnZhc0RPTUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICAgIHsgdG9wLCBsZWZ0IH0gPSBib3VuZGluZ0NsaWVudFJlY3QsXG4gICAgICAgIG1vdXNlQ29vcmRpbmF0ZXMgPSBbXG4gICAgICAgICAgY2xpZW50WCAtIGxlZnQsXG4gICAgICAgICAgdG9wIC0gY2xpZW50WVxuICAgICAgICBdO1xuXG4gIHJldHVybiBtb3VzZUNvb3JkaW5hdGVzO1xufVxuIl0sIm5hbWVzIjpbIk1vdXNlRXZlbnRzIiwiaGFuZGxlcnNNYXAiLCJtb3VzZURvd24iLCJ3aGVlbEV2ZW50TGlzdGVuZXIiLCJldmVudCIsImhhbmRsZXJzIiwiV0hFRUxfRVZFTlRfVFlQRSIsIm1vdXNlV2hlZWxEZWx0YSIsIm1vdXNlV2hlZWxEZWx0YUZyb21FdmVudCIsImZvckVhY2giLCJoYW5kbGVyIiwicHJldmVudERlZmF1bHQiLCJtb3VzZUV2ZW50TGlzdGVuZXIiLCJldmVudFR5cGUiLCJtb3VzZUNvb3JkaW5hdGVzIiwibW91c2VDb29yZGluYXRlc0Zyb21FdmVudCIsIm1vdXNlVXBFdmVudExpc3RlbmVyIiwiTU9VU0VVUF9FVkVOVF9UWVBFIiwibW91c2VEb3duRXZlbnRMaXN0ZW5lciIsIk1PVVNFRE9XTl9FVkVOVF9UWVBFIiwibW91c2VNb3ZlRXZlbnRMaXN0ZW5lciIsIk1PVVNFTU9WRV9FVkVOVF9UWVBFIiwiYWRkTW91c2VVcEhhbmRsZXIiLCJtb3VzZVVwSGFuZGxlciIsIm1vdXNlVXBIYW5kbGVycyIsInB1c2giLCJhZGRNb3VzZURvd25IYW5kbGVyIiwibW91c2VEb3duSGFuZGxlciIsIm1vdXNlRG93bkhhbmRsZXJzIiwiYWRkTW91c2VNb3ZlSGFuZGxlciIsIm1vdXNlTW92ZUhhbmRsZXIiLCJtb3VzZU1vdmVIYW5kbGVycyIsImFkZE1vdXNlV2hlZWxIYW5kbGVyIiwibW91c2VXaGVlbEhhbmRsZXIiLCJtb3VzZVdoZWVsSGFuZGxlcnMiLCJpbml0aWFsaXNlIiwiY2FudmFzIiwiY2FudmFzRE9NRWxlbWVudCIsImdldERPTUVsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZnJvbU5vdGhpbmciLCJtb3VzZUV2ZW50cyIsIndoZWVsRGVsdGEiLCJNYXRoIiwibWF4IiwibWluIiwidGFyZ2V0IiwiY2xpZW50WCIsImNsaWVudFkiLCJib3VuZGluZ0NsaWVudFJlY3QiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ0b3AiLCJsZWZ0Il0sIm1hcHBpbmdzIjoiQUFBQTs7OzsrQkFJQTs7O2VBQXFCQTs7OzRCQUY0RTtBQUVsRixNQUFNQTtJQUNuQixZQUFZQyxXQUFXLEVBQUVDLFNBQVMsQ0FBRTtRQUNsQyxJQUFJLENBQUNELFdBQVcsR0FBR0E7UUFDbkIsSUFBSSxDQUFDQyxTQUFTLEdBQUdBO0lBQ25CO0lBRUFDLHFCQUFxQixDQUFDQztRQUNwQixNQUFNQyxXQUFXLElBQUksQ0FBQ0osV0FBVyxDQUFFSyw0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